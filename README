How to run workflow on wcoss phase 2 

1. code checkout and system build:
git clone https://github.com/JessicaMeixner-NOAA/global-workflow global-workflow-ufsp4
cd global-workflow-ufsp4
git checkout ufs_s2s_p4_wcossphase2
git submodule update --init --recursive
cd sorc
sh checkout.sh
sh build_all.sh  #there is no clean before building ufs-s2s-model, clean manually if needed 
sh link_fv3gfs.sh emc wcoss

2. configuration:
(a) /parm/config/config.base

elif [ $machine = "WCOSS" ]; then
    export ACCOUNT="CFS-T2O"   <-- change to your group account if needed

HPSS_PROJECT=emc-marine  <-- change to your group account if needed

export FHMAX=840  <-- change forecast length if needed
export FHMAX_GFS_00=840  <-- change forecast length if needed

export RUNDIR="$STMP/RUNDIRS/$PSLOT"  <-- it is set to /ptmpp2/Yout ID/$PSLOT now, you can change to any disk

(b) /ush/rocoto/cpl_setup.sh

IDATE=2016010100  <-- fcst IC date

RES=384  <-- fv3 resolution

FROM_HPSS=/global/noscrub/Jiande.Wang/WF/FROM_HPSS
FV3DATA=$FROM_HPSS/$IDATE/gfs/C384/INPUT  <-- this is where I put IC on pahse 2 machine

COMROT=/ptmpp2/Jiande.Wang/P2-verify/COMFV3  <-- make your own directory here, this is location where run log file will be

CONFIGDIR=   <-- change to path to where your fv3gfs_benchmark-P2/parm/config is

EXPDIR=  <-- make your own directory here, this will be your experiment directory where xml and rocoto database files will be

3. run the system:
(a) generate xml and rocoto database:
  ush/rocoto/cpl_setup.sh: this will generate a xml file in your EXPDIR, for example, if you run at C384, it will have a file "c384.xml" under $EXPDIR/c384 directory

(b) got to your EXPDIR/$PSLOT
to make a test run manually: rocotorun -d c384.db -w c384.xml
to run under cron mode: crontab c384.crontab 
note most of phase 2 interactive nodes don't allow you to setup cron jobs, I always use t10a1(tide) 
and g10a1(gyre), occasionally t10a1 or g10a1 may indergo short period of system maintenance without notice. 

4. remaining issue (I will try to find the root cause and fixing of them when I am back):
(a) post job is slow

(b) somehow phase 2 machine doesn't like the file "c384.crontab" being generated by the system (at least to my login ID).
this is an example of the crontabb file automatically being generated:

*/5 * * * * (. /usrx/local/Modules/default/init/sh; module use -a /usrx/local/emc_rocoto/modulefiles; 
module load rocoto/20170119-master) /usrx/local/emc_rocoto/1.2.4/bin/rocotorun -d 
/ptmpp2/Jiande.Wang/P2-verify/c384/c384.db -w /ptmpp2/Jiande.Wang/P2-verify/c384/c384.xml)

I made it working by manually remove all "(", ")", and add module add lsf/9.1 in the crontab file

so the modified crontab file looks like
*/5 * * * * . /usrx/local/Modules/default/init/sh; module load lsf/9.1; 
module use -a /usrx/local/emc_rocoto/modulefiles; module load rocoto/20170119-master; 
/usrx/local/emc_rocoto/1.2.4/bin/rocotorun -d 
/ptmpp2/Jiande.Wang/P2-verify/c384/c384.db -w /ptmpp2/Jiande.Wang/P2-verify/c384/c384.xml
